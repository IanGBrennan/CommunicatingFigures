---
title: "Intro to gganimate"
author: "Ian G. Brennan"
#date: "02/12/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message=F}
library(transformr)
library(gganimate)
library(ggplot2)
library(RColorBrewer)
library(dplyr)
```

```{r, include=F}
setwd("~/Documents/GitHub/CommunicatingFigures")
```

```{r}
goannas <- readRDS("Goannas.RDS")
traits <- mutate(goannas$size.data,
                 TailRatio = Tail/Body_Length)
```

```{r}
gramp <- colorRampPalette(brewer.pal(5, "YlGnBu"))
gcolors <- gramp(nrow(traits)); 
traits <- traits[order(traits$Body_Length),]
traits <- mutate(traits, plotcols = gcolors)
```

```{r}
TailSVL <- ggplot(traits, 
                  aes(x=log(Body_Length), 
                      y=log(Tail),
                      size=TailRatio)) +
  geom_point(alpha=0.75, 
             show.legend=FALSE, 
             color="black", 
             fill=traits$plotcols, 
             shape=21) + 
  # designate color here to keep the smoothness
  theme_bw() +
  scale_size(range=c(5,20)) +
  labs(title="Habitat: {closest_state}") + 
  # this will label the plot by the groupings
  transition_states(Habitat, 
                    transition_length=5, 
                    state_length=3) +
  ease_aes('cubic-in-out')
```

```{r, include=F, eval=F}
TailSVL
```


```{r, eval=T}
anim_save(TailSVL, file="TailSVL.gif")
```

![](TailSVL.gif)